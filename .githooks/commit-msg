#!/bin/bash
# commit-msg: enforce <type>(<scope>): message pattern

COMMIT_MSG_FILE="$1"
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

echo "=============================================================="
echo "COMMIT-MSG CHECK: Enforcing '<type>(<scope>): message' pattern"
echo "--------------------------------------------------------------"

# Allowed types
TYPES="chore|feat|fix|docs|refactor|test|style|perf|ci|build"

PATTERN="^($TYPES)\([a-zA-Z0-9_-]+\): .+"

if ! [[ "$COMMIT_MSG" =~ $PATTERN ]]; then
    echo "ERROR: Commit message must follow the pattern '<type>(<scope>): message'"
    echo "Allowed types: $TYPES"
    echo "Example: feat(auth): add login feature"
    echo "Commit aborted."
    echo "=============================================================="
    exit 1
fi

echo "Commit message is valid."
echo "=============================================================="
exit 0
